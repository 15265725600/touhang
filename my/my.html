<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>投行365</title>
    <link rel="stylesheet" href="../assets/css/amazeui.min.css">
    <link rel="stylesheet" href="../assets/css/style.css">
  </head>

  <body>
    <div class="my-container">
      <div class="my-top">
        <div class="log-header">
          <a href="javascript:history.back()" class="arrow-left"></a>
          <h5 class="title">个人中心</h5>
        </div>
        <div class="content">
          <a href="personal-information.html">
            <div class="left" id="my_infor">
              <script type="text/html" id="template">
                <div class="avatar"><img src="{{infor[0].avatar}}" width="75" height="75" /></div>
                <div class="name">{{infor[0].username}}</div>
              </script>
            </div>
          </a>
          <div class="right clearfix">
            <a href="information.html" class="infor am-fr"><span class="count" id="count"></span></a>
            <a href="set.html" class="set am-fr"></a>
          </div>
        </div>
      </div>
      <ul class="my-list">
        <li class="list-item">
          <a href="information.html">
            <div class="left"><img src="../assets/i/m (1).png" width="20" height="18" />消息通知</div>
          </a>
          <i class="arrow-right"></i>
        </li>
        <li class="list-item">
          <a href="my-friends.html">
            <div class="left" style="font-weight: 700;"><img src="../assets/i/m (6).png" width="20" height="18" />我的好友</div>
          </a>
          <i class="arrow-right"></i>
        </li>
        <li class="list-item">
          <a href="my-wallet.html">
            <div class="left"><img src="../assets/i/m (5).png" width="20" height="18" />我的钱包</div>
          </a>
          <i class="arrow-right"></i>
        </li>
         <li class="list-item" id="recommend">
          <a href="javascript:;">
            <div class="left"><img src="../assets/i/m (3).png" width="20" height="18" />推荐给好友</div>
          </a>
          <i class="arrow-right"></i>
        </li>
        <li class="list-item">
          <a href="send-card.html">
            <div class="left"><img src="../assets/i/m (10).png" width="20" height="18" />发送名片</div>
          </a>
          <i class="arrow-right"></i>
        </li>
        <li class="list-item">
          <a href="send-word.html">
            <div class="left"><img src="../assets/i/m (2).png" width="20" height="18" />发送文件</div>
          </a>
          <i class="arrow-right"></i>
        </li>
       
        <li class="list-item">
          <a href="article-delivery.html">
            <div class="left"><img src="../assets/i/m (4).png" width="20" height="18" />文章投递</div>
          </a>
          <i class="arrow-right"></i>
        </li>
         <li class="list-item">
          <a href="feedback.html">
            <div class="left"><img src="../assets/i/m (8).png" width="20" height="20" />问题反馈</div>
          </a>
          <i class="arrow-right"></i>
        </li>
        <li class="list-item">
          <a href="member-center.html">
            <div class="left"><img src="../assets/i/m (7).png" width="20" height="18" />会员中心</div>
          </a>
          <i class="arrow-right"></i>
        </li>
        <li class="list-item">
          <a href="about-us.html">
            <div class="left"><img src="../assets/i/m (9).png" width="20" height="20" />关于我们</div>
          </a>
          <i class="arrow-right"></i>
        </li>
      </ul>
      <div class="out-login">退出登录</div>
    </div>
    <!--footer-->
    <footer class="am-cf">
      <div data-am-widget="navbar" class="am-navbar am-cf" id="">
        <ul class="am-navbar-nav am-cf am-avg-sm-4 foot-wrapper">
          <li class="foot_item">
            <a href="../find-expert/index.html">
              <i class="expert"></i>
              <span class="active">找行家</span>
            </a>
          </li>
          <li class="foot_item">
            <a href="../find-specialist/index.html" class="">
              <i class="specialist"></i>
              <span class="">找专家</span>
            </a>
          </li>
          <li class="foot_item">
            <a href="../find-project/index.html" class="">
              <i class="project"></i>
              <span class="">找项目</span>
            </a>
          </li>
          <li class="foot_item">
            <a href="javascript:;" class="">
              <i class="my active"></i>
              <span class="">我的</span>
            </a>
          </li>
        </ul>
      </div>
    </footer>
    <!--退出登录-->
    <div class="am-modal am-modal-alert" tabindex="-1" id="my-alert">
      <div class="am-modal-dialog customer-service">
        <div class="am-modal-hd title" style="padding: 20px 0;border: 1px solid #dddddd;font-size: 16px;">确定要退出登录吗</div>
        <div class="am-modal-footer">
          <span class="am-modal-btn del" style="font-size: 14px;">取消</span>
          <span class="am-modal-btn confirm" style="font-size: 14px;">确定</span>
        </div>
      </div>
    </div>
    <!--推荐给好友-->
    <div class="am-modal am-modal-no-btn" tabindex="-1" id="doc-modal-1">
      <div class="am-modal-dialog">
        <div class="am-modal-bd model-share">
          <div id="qrcode"></div>
          <span class="desc">长按发送给朋友</span>
        </div>
      </div>
    </div>
  </body>
  <script type="text/javascript" src="../assets/js/jquery.min.js"></script>
  <script type="text/javascript" src="../assets/js/amazeui.min.js"></script>
  <script type="text/javascript" src="../assets/js/picker.min.js"></script>
  <script type="text/javascript" src="../assets/js/qrcode.min.js"></script>
  <script type="text/javascript" src="../assets/js/common.js"></script>
  <script type="text/javascript" src="../assets/js/template.js"></script>

  <script>
    $(function() {
      //获取个人信息
      var token = getCookie('token');
      var flag = GetQueryString('flag');
      console.log(flag)
      if(flag){
        mask(flag)
      }
      var invite_code = "";
      var params = {
        token: token
      };
      postAjax(reqUrl('client_get'), params, false, function(data) {
        if(data.error_code == 200) {
          window.location.href = preUrl('log/login.html?path=my/my.html');
        } else if(data.success) {
          var html = template('template', data);
          $('#my_infor').html(html);
          invite_code = data.infor[0].recomcode;

        } else {
          mask(data.msg);
        }
      });

      //获取未读消息数量
      postAjax(reqUrl('notice_num'), {
        token: token
      }, false, function(data) {
        if(data.error_code == 200) {
          window.location.href = preUrl('log/login.html?path=my/my.html');
        } else if(data.success) {
          var unread = data.infor[0].num;
          if(unread < 0 || unread == 0){
            $('#count').hide();
          }else{
            $('#count').show();
            $('#count').html(unread);
          }
          
        } else {
          mask(data.msg);
        }
      });

      $('.out-login').click(function(){
        $('#my-alert').modal();
      })
      //退出登录
      $('.confirm').on('click', function() {
        postAjax(reqUrl('client_loginout'), {
          token: token
        }, false, function(data) {
          if(data.error_code == 200) {
            window.location.href = preUrl('log/login.html?path=my/my.html');
          } else if(data.success) {
            window.location.href = preUrl('log/login.html');
          } else {
            mask(data.msg);
          }
        })
      });

      //生成二维码
      $('#recommend').click(function() {
        console.log(invite_code)
        var invitedUrl = preUrl('log/register.html?invited_code=' + invite_code + '');
        console.log(invitedUrl)
        $('#doc-modal-1').modal();
        qrcode.makeCode(invitedUrl);
      });
      var qrcode = new QRCode('qrcode', {
        width: 160,
        height: 160,
      });

    })
  </script>

</html>